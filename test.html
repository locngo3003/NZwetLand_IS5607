<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>REMOVE OBSERVATION</title>
    <script
            src="https://code.jquery.com/jquery-3.5.1.min.js"
            integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
            crossorigin="anonymous">
    </script>
    <script src="js/script.js"></script>
    <script>
        $(document).ready(function (){

            $.ajax({
                type: 'Get',
                dataType: 'JSON',
                url: 'https://nzwetland.herokuapp.com/api/Sitehabitat/',
                success: function (data) {
                    // location.reload();

                    i = 0;
                    while (i < data.length){
                        sitehabitats = data[i];
                        $("#siteHabitat_id_input").append("<option value='"+sitehabitats.id+"'>" +
                            "" +sitehabitats.id+
                            " | "+sitehabitats.sitehabitatname+"\</option>");
                        i = i + 1;
                    }
                    $("#siteHabitat_id_input").change(function (){
                        siteHabitat = getSingleSiteHabitat($("#siteHabitat_id_input").val());
                        console.log('sitehabitat',siteHabitat)
                        $("#siteHabitat_id").text(siteHabitat.id);
                        $("#siteHabitat_name").text(siteHabitat.sitehabitatname);
                        sitename1 = siteHabitat.site;
                        console.log('sitename1',sitename1)
                        sitename2 = getSingleSite(sitename1)
                        console.log('sitename2',sitename2)
                        $("#site_name").text(sitename2.sitename);

                        recordedObservations = recordedObservation($("#siteHabitat_id_input").val());
                        console.log("recordedObservations",recordedObservations)
                        $("#observation_input").empty();
                        $("#observation_input").append("<option value=''>Select one</option>");
                        j = 0;
                        while (j<recordedObservations.length){
                            observationAnimal = recordedObservations[j].animal;
                            animal12 = getSingleanimal(observationAnimal);
                            observationSuvey = recordedObservations[j].survey;
                            survey12 = getSingleSurvey(observationSuvey)

                            $("#observation_input").append("<option value='"+recordedObservations[j].id+"'>" +
                                " |Animal ID: " +animal12.id+
                                " |Animal common name: " +animal12.commonname+
                                " | Ob Status: " + recordedObservations[j].status +
                                " | Ob number: " + recordedObservations[j].observationnumber +
                                " | Survey name: " + survey12.surveyname +
                                "</option>");
                            j++;
                        }
                        $("#observation_input").change(function (){


                        })

                    })
                },
                error: function (err) {
                    console.log(err);
                }
            });
        })


        $(document).ready(function () {
            $("#remove_but").click(function () {
                removeobservation      = $("#observation_input").val();
                $.ajax({
                    type: 'DELETE',
                    dataType: 'JSON',
                    url: 'https://nzwetland.herokuapp.com/api/Observation/'+removeobservation,
                    success: function (data) {
                        alert('Assignment  removed successfully');
                        location.reload();
                    },
                    error: function (err) {
                        console.log(err);
                        errors = JSON.parse(err.responseText);
                        console.log(errors);
                        $("#department_id_input_err").text(errors.name);
                    }
                });
            });
        });
    </script>
</head>
<body>
<div style="background-color: darkgray;width: fit-content">
    <div>
        <h4 style="text-align: center">REMOVE OBSERVATION</h4>
        <form onsubmit="return false">
            <div class="remove_observation" style="background-color: aqua">

                <table>
                    <tr>
                        <td>Site Habitat:</td>
                        <td><select id="siteHabitat_id_input">
                            <option value="">Select one</option>
                        </select>
                        </td>
                    </tr>
                    <tr>
                        <td>Site Habitat ID:</td>
                        <td id="siteHabitat_id"></td>
                    </tr>
                    <tr>
                        <td>Site Habitat name:</td>
                        <td id="siteHabitat_name"></td>
                    </tr>
                    <tr>
                        <td>Site Name:</td>
                        <td id="site_name"></td>
                    </tr>
                </table>
            </div>


            <div class="observation" style="margin-top: 20px;background-color: aqua">
                <table>
                    <tr>
                        <td>Observation:</td>
                        <td> <select id="observation_input">
                            <option value="">Select one</option>
                        </select></td>
                    </tr>
                    <tr>
                        <td>animal ID:</td>
                        <td id="animal_id"></td>
                    </tr>
                    <tr>
                        <td>Common Name:</td>
                        <td id="animal_common_name"></td>
                    </tr>
                    <tr>
                        <td>Observation Status:</td>
                        <td id="observation_status"></td>
                    </tr>
                    <tr>
                        <td>Observation Number:</td>
                        <td id="observation_number"></td>
                    </tr>
                    <tr>
                        <td>Survey Name:</td>
                        <td id="survey_name"></td>
                    </tr>
                </table>
            </div>

        </form>
        <div class="div_but" style="text-align: center">

            <button id="remove_but">REMOVE OBSERVATION</button>
            <button >RETURN</button>
        </div>

    </div>
</div>

</body>
</html>